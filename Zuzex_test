- 1.Написать запрос для вывода пользователей, которые не создали ни одного
поста и не оставили ни одного коммента. (несколько вариантов запроса)

SELECT *
FROM USERS
WHERE ID NOT IN (SELECT USERID FROM COMMENTS) AND ID NOT IN (select OwnerUserId FROM POSTS)


2. Написать запрос для вывода года, кол-ва постов за год и кол-во комментов за
год.

SELECT YEAR, COUNT(DISTINCT POST_ID) AS COUNT_OF_POSTS, COUNT(COMMENT_ID) AS COUNT_OF_COMMENTS
FROM
(SELECT ID AS POST_ID, YEAR(CreationDate) AS YEAR, C.ID AS COMMENT_ID
FROM POSTS AS P INNER JOIN COMMENTS C
ON P.ID = C.PostId) as S
GROUP BY YEAR

3. Вывести 3 самых активных (по кол-ву комментариев) пользователей (display
name) и их кол-во комментариев
WITH RANKED_COMMENTS_TABLE AS (
SELECT DISTINCT UserID, COUNT(ID) OVER(PARTITION BY UserID) AS COMMENT_COUNT
FROM
COMMENTS
ORDER BY DESC COMMENT_COUNT
LIMIT 3)


SELECT DISPLAYNAME, COMMENT_COUNT
FROM RANKED_COMMENTS_TABLE AS RCT INNER JOIN USERS U
ON RCT.UserID=U.ID

4. 
Расширить п.3, добавив процент кол-ва комментариев пользователя от общего
кол-ва


WITH RANKED_COMMENTS_TABLE AS (
SELECT DISTINCT USER_ID, COUNT(ID) OVER(PARTITION BY USER_ID) AS COUNT_OF_COMMENTS, SUM(ID) OVER() AS TOTAL_COMMENTS

FROM
COMMENTS
ORDER BY DESC COUNT_OF_COMMENTS
LIMIT 3)

SELECT DISPLAYNAME, COMMENT_COUNT, CONCAT((COUNT_OF_COMMENTS * 100) / TOTAL_COMMENTS, "%") AS PERCANTAGE_TOTAL
FROM RANKED_COMMENTS_TABLE AS RCT INNER JOIN USERS U
ON RCT.USER_ID=U.ID
